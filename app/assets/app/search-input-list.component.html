<div class="card">
  <div class="card-body">
    <div class="input-group">
      <input type="text"
             class="form-control"
             placeholder="Search or Create Item..."
             [(ngModel)]="searchInputTerm"
             (keyup.enter)="openAddItemModal()">
      <span class="input-group-btn" *ngIf="isTaggingActive() && allTags.length > 0">
        <button id="filterTagsDropdown"
                type="button"
                class="btn btn-outline-primary dropdown-toggle"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false">
          {{ tagFilter == null ? "All Tags" : tagFilter.displayValue }}
        </button>
        <div class="dropdown-menu" aria-labelledby="filterTagsDropdown">
          <span class="dropdown-item" (click)="filterByTag(null)">All Tags</span>
          <span *ngFor="let tag of allTags" class="dropdown-item" (click)="filterByTag(tag)">{{tag.displayValue}}</span>
        </div>
      </span>
      <span class="input-group-btn">
        <button class="btn btn-success"
                type="button"
                (click)="openAddItemModal()">
          <i class="fa fa-plus" aria-hidden="true"></i> New
        </button>
      </span>
    </div>
  </div>
</div>

<div *ngIf="getFilteredListItems(); let filteredListItems">
  
  <div class="smui-number-of-results">
    {{filteredListItems.length}} <span *ngIf="filteredListItems.length !== listItems.length">of {{listItems.length}}</span> items
  </div>
  <ul class="list-group smui-search-input-list" >
    <ng-container *ngFor="let listItem of filteredListItems; let idxListItem = index">
      <li *ngIf="isShowingAllItems || (limitItemsTo > 0 && idxListItem < limitItemsTo)"
          [ngClass]="{'active': selectedListItem && selectedListItem.id === listItem.id, 'list-group-item': true,
          'smui-list-group-item': true, 'smui-strikethrough': !listItem.isActive,
          'smui-spelling-item': listItem.itemType === 'Spelling' && (!selectedListItem || selectedListItem && selectedListItem.id !== listItem.id) }"
          (click)="selectListItem(listItem)"
      >
        <span class="smui-right-gap smui-align-middle">
          <i *ngIf="listItem.itemType === 'Spelling'" class="fa fa-comments-o smui-align-middle" aria-hidden="true"></i>
          <i *ngIf="listItem.itemType === 'RuleManagement'" class="fa fa-list smui-align-middle" aria-hidden="true"></i>
        </span>

        <span class="smui-align-middle">{{ listItem.term }}</span>

        <ng-container *ngFor="let listItemSynonym of listItem.synonyms">
          <!-- TODO evaluate whether to show or hide undirected synonyms, that are not active -->
          <small class="text-muted smui-input-list-divide-synonym">
            {{ listItemSynonym }}
          </small>
        </ng-container>

        <span class="smui-tags-container">
          <span *ngFor="let tag of listItem.tags" class="badge badge-pill badge-info smui-tag">
            {{ tag.displayValue }}
          </span>
        </span>

        <button type="button" class="btn btn-danger btn-sm float-right" (click)="deleteItem(listItem.itemType, listItem.id); $event.stopPropagation();">
          <i class="fa fa-minus" aria-hidden="true"></i>
        </button>

        <span class="badge badge-pill badge-info"
              *ngIf="listItem.comment.trim().length > 0">
          <i class="fa fa-commenting-o"
             aria-hidden="true"
             data-toggle="tooltip"
             data-placement="top"
             [title]="listItem.comment.trim()"></i>
        </span>
      </li>
    </ng-container>
  </ul>
  <button type="button"
          *ngIf="!this.isShowingAllItems && this.limitItemsTo > 0 && filteredListItems.length > limitItemsTo"
          class="btn btn-link pull-right" (click)="toggleShowMore()">
    <i class="fa fa-plus smui-icon"></i>Show all items
  </button>
  <button type="button"
          *ngIf="this.isShowingAllItems && this.limitItemsTo > 0 && filteredListItems.length > limitItemsTo"
          class="btn btn-link pull-right" (click)="toggleShowMore()">
    <i class="fa fa-plus smui-icon"></i>Show less items
  </button>
</div>

<div class="modal fade" id="addItemModal" tabindex="-1" role="dialog" aria-labelledby="addItemTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addItemTitle">Add new rule management or spelling item</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Please select if you want to add a new rule management or spelling item...</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="createNewSpellingItem()">
          <i class="fa fa-comments-o smui-icon"></i>Spelling
        </button>
        <button type="button" class="btn btn-success" data-dismiss="modal" (click)="createNewRuleItem()">
          <i class="fa fa-list smui-icon"></i>Rule Management
        </button>
      </div>
    </div>
  </div>
</div>